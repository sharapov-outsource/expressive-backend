version: '3'
services:
  webapi:
    build:
      context: .
      dockerfile: Dockerfile.webapi
    container_name: ${TEST_PROJECT}_webapi_container
    volumes:
      - ../../etc/ssl:/etc/ssl
      - ../../etc/log:/var/log/nginx
      - ../../html:/var/www/html
      - ../../docker/socket:/socket
    ports:
      - 8000:8000
      - 4433:4433
    restart: always
    depends_on:
      - phpfpm
   #   - mysql8
    networks:
      - backend
      - frontend
  phpfpm:
    build:
      context: .
      dockerfile: Dockerfile.phpfpm
    container_name: ${TEST_PROJECT}_phpfpm_container
    restart: always
    volumes:
      - ../../:/var/www
      - ../../etc/tmp:/tmp
      - ../../etc/log:/var/log
      - ../../docker/socket:/socket
    #depends_on:
     # - mysql8
    networks:
      - backend

networks:
  backend:
  frontend:

volumes:
  mysql8:
